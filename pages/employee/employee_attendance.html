<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Attendance â€” GDC ManPower</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & VARIABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --red-900: #3d0c0c;
  --red-800: #5a1010;
  --red-500: #b91c1c;
  --red-400: #dc2626;
  --red-300: #f87171;
  --red-100: #fee2e2;
  --red-50:  #fff5f5;
  --amber:        #d97706;
  --amber-light:  #fef3c7;
  --green:        #16a34a;
  --green-light:  #dcfce7;
  --blue:         #2563eb;
  --blue-light:   #dbeafe;
  --purple:       #7c3aed;
  --purple-light: #ede9fe;
  --gray-900: #111827;
  --gray-700: #374151;
  --gray-500: #6b7280;
  --gray-400: #9ca3af;
  --gray-300: #d1d5db;
  --gray-200: #e5e7eb;
  --gray-100: #f3f4f6;
  --gray-50:  #f9fafb;
  --bg: #f0efed;
  --sidebar-w: 240px;
  --safe-bottom: env(safe-area-inset-bottom, 12px);
  --radius: 16px;
}

html, body { height: 100%; }
body {
  font-family: 'Plus Jakarta Sans', sans-serif;
  background: var(--bg);
  color: var(--gray-900);
  -webkit-font-smoothing: antialiased;
  min-height: 100vh;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.app-shell { display: flex; min-height: 100vh; }

.sidebar {
  width: var(--sidebar-w);
  background: linear-gradient(180deg, var(--red-900) 0%, #1a0505 100%);
  display: none;
  flex-direction: column;
  position: fixed; top: 0; left: 0; bottom: 0;
  z-index: 50; overflow-y: auto;
}

.sb-logo { padding: 22px 18px 16px; border-bottom: 1px solid rgba(255,255,255,0.07); }
.sb-logo-row { display: flex; align-items: center; gap: 10px; }
.sb-logo-icon { width: 40px; height: 40px; background: var(--red-500); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 800; color: #fff; font-size: 13px; letter-spacing: 1px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
.sb-logo-title { color: #fff; font-weight: 800; font-size: 14px; }
.sb-logo-sub   { color: var(--red-300); font-size: 9px; letter-spacing: 2.5px; font-weight: 700; }
.sb-user-pill  { display: inline-block; margin-top: 12px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.7); border-radius: 20px; padding: 4px 12px; font-size: 11px; font-weight: 600; }

.sb-section-lbl { padding: 14px 18px 4px; color: rgba(255,255,255,0.28); font-size: 9px; letter-spacing: 2.5px; font-weight: 700; text-transform: uppercase; }

.sb-nav-item { display: flex; align-items: center; gap: 10px; padding: 11px 18px; color: rgba(255,255,255,0.5); font-size: 13px; font-weight: 500; cursor: pointer; border: none; border-left: 3px solid transparent; background: none; font-family: inherit; width: 100%; text-align: left; transition: all 0.15s; }
.sb-nav-item:hover  { color: rgba(255,255,255,0.85); background: rgba(255,255,255,0.04); }
.sb-nav-item.active { color: #fff; background: rgba(255,255,255,0.1); border-left-color: var(--red-300); font-weight: 700; }
.sb-nav-icon { font-size: 16px; width: 20px; text-align: center; }

.sb-footer { padding: 14px 18px; border-top: 1px solid rgba(255,255,255,0.07); margin-top: auto; display: flex; align-items: center; gap: 10px; }
.sb-avatar { width: 36px; height: 36px; background: var(--red-500); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 800; font-size: 13px; flex-shrink: 0; }
.sb-footer-name { color: #fff; font-size: 12px; font-weight: 700; }
.sb-footer-role { color: rgba(255,255,255,0.38); font-size: 10px; }

.main-wrap { flex: 1; display: flex; flex-direction: column; min-width: 0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOPBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.topbar {
  background: linear-gradient(145deg, var(--red-900) 0%, var(--red-800) 100%);
  padding: 44px 20px 56px; position: relative; overflow: hidden;
}
.topbar::before { content:""; position:absolute; width:240px; height:240px; background:rgba(255,255,255,0.04); border-radius:50%; top:-70px; right:-50px; }
.topbar::after  { content:""; position:absolute; width:130px; height:130px; background:rgba(255,255,255,0.03); border-radius:50%; bottom:0px; left:-30px; }

.topbar-inner { display: flex; align-items: flex-start; justify-content: space-between; position: relative; z-index: 1; }
.greeting-hello  { color: rgba(255,255,255,0.5); font-size: 12px; font-weight: 500; }
.greeting-name   { color: #fff; font-size: 20px; font-weight: 800; margin-top: 2px; }
.greeting-branch { color: rgba(255,255,255,0.4); font-size: 12px; margin-top: 2px; }
.topbar-right    { display: flex; align-items: center; gap: 10px; }
.icon-btn { width: 40px; height: 40px; background: rgba(255,255,255,0.12); border-radius: 12px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; }
.avatar-btn { width: 40px; height: 40px; background: var(--red-500); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 800; font-size: 14px; border: none; cursor: pointer; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.content-area { padding: 0 14px 100px; flex: 1; }
.float-wrap   { margin-top: -40px; position: relative; z-index: 10; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIME-IN HERO CARD (Geofencing)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.timein-hero {
  background: #fff;
  border-radius: 22px;
  padding: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.12);
  overflow: hidden;
  position: relative;
}

.th-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
.th-title { font-size: 13px; font-weight: 800; color: var(--gray-900); }
.th-subtitle { font-size: 11px; color: var(--gray-500); margin-top: 2px; }

.geo-status-pill {
  display: flex; align-items: center; gap: 6px;
  border-radius: 20px; padding: 5px 12px;
  font-size: 11px; font-weight: 700;
}
.geo-status-pill.inside  { background: var(--green-light); color: var(--green); }
.geo-status-pill.outside { background: var(--red-100); color: var(--red-500); }
.geo-status-pill.checking{ background: var(--amber-light); color: var(--amber); }
.geo-pulse { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.geo-pulse.inside  { background: var(--green); animation: pulse-green 1.5s infinite; }
.geo-pulse.outside { background: var(--red-400); }
.geo-pulse.checking{ background: var(--amber); animation: pulse-amber 1.5s infinite; }

@keyframes pulse-green {
  0%,100% { box-shadow: 0 0 0 0 rgba(22,163,74,0.5); }
  50%      { box-shadow: 0 0 0 5px rgba(22,163,74,0); }
}
@keyframes pulse-amber {
  0%,100% { box-shadow: 0 0 0 0 rgba(217,119,6,0.5); }
  50%      { box-shadow: 0 0 0 5px rgba(217,119,6,0); }
}

/* Geo mini map visual */
.geo-map-visual {
  background: linear-gradient(145deg, #e8f5e9, #f1f8e9);
  border-radius: 16px; height: 110px; margin-bottom: 14px;
  position: relative; overflow: hidden; border: 1px solid #c8e6c9;
}
.geo-map-bg {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(rgba(0,0,0,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.04) 1px, transparent 1px);
  background-size: 20px 20px;
}
.geo-zone {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 80px; height: 80px; border-radius: 50%;
  border: 2px dashed var(--green); background: rgba(22,163,74,0.1);
  display: flex; align-items: center; justify-content: center;
  animation: zone-pulse 3s ease-in-out infinite;
}
@keyframes zone-pulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(22,163,74,0.2); }
  50%      { box-shadow: 0 0 0 16px rgba(22,163,74,0); }
}
.geo-zone-label { font-size: 9px; font-weight: 800; color: var(--green); text-align: center; line-height: 1.2; }
.geo-marker {
  position: absolute; font-size: 22px;
  transition: all 0.5s cubic-bezier(.4,0,.2,1);
}
.geo-marker.inside  { top: 50%; left: 50%; transform: translate(-50%, -70%); }
.geo-marker.outside { top: 20%; left: 20%; transform: translate(-50%, -50%); }

.geo-info-row {
  display: flex; gap: 8px; margin-bottom: 14px;
}
.geo-info-cell {
  flex: 1; background: var(--gray-50); border-radius: 12px;
  padding: 10px 12px;
}
.geo-info-label { font-size: 10px; color: var(--gray-500); font-weight: 600; margin-bottom: 2px; }
.geo-info-val   { font-size: 12px; font-weight: 800; color: var(--gray-900); }

/* Current time display */
.live-clock {
  text-align: center; font-size: 38px; font-weight: 800;
  letter-spacing: -1px; color: var(--gray-900); margin-bottom: 4px;
  font-variant-numeric: tabular-nums;
}
.live-date { text-align: center; font-size: 12px; color: var(--gray-500); margin-bottom: 16px; }

/* Big Time In button */
.btn-geo-timein {
  width: 100%; border: none; border-radius: 16px;
  padding: 16px 20px; font-size: 16px; font-weight: 800;
  cursor: pointer; font-family: inherit;
  display: flex; align-items: center; justify-content: center; gap: 10px;
  transition: all 0.2s; -webkit-tap-highlight-color: transparent;
}
.btn-geo-timein.ready {
  background: linear-gradient(135deg, var(--red-500), var(--red-400));
  color: #fff; box-shadow: 0 4px 18px rgba(185,28,28,0.4);
}
.btn-geo-timein.ready:active { transform: scale(0.98); }
.btn-geo-timein.out-zone {
  background: var(--gray-100); color: var(--gray-400);
  cursor: not-allowed; box-shadow: none;
}
.btn-geo-timein.clocked-out {
  background: linear-gradient(135deg, var(--green), #22c55e);
  color: #fff; box-shadow: 0 4px 18px rgba(22,163,74,0.4);
}
.btn-geo-timein.done {
  background: var(--gray-100); color: var(--gray-400);
  cursor: default; box-shadow: none;
}

.out-zone-notice {
  display: none;
  margin-top: 10px; background: var(--red-50); border: 1px solid var(--red-100);
  border-radius: 12px; padding: 10px 14px;
  font-size: 12px; color: var(--red-500); font-weight: 600;
  text-align: center; line-height: 1.4;
}
.out-zone-notice.show { display: block; }

/* Today times row */
.today-times { display: grid; grid-template-columns: repeat(3,1fr); gap: 8px; margin-top: 14px; }
.tt-cell { background: var(--gray-50); border-radius: 12px; padding: 10px; text-align: center; }
.tt-val  { font-size: 15px; font-weight: 800; color: var(--gray-900); }
.tt-lbl  { font-size: 10px; color: var(--gray-500); margin-top: 2px; font-weight: 600; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.section { margin-top: 20px; }
.section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.section-title  { font-size: 15px; font-weight: 800; }
.section-link   { font-size: 12px; color: var(--red-500); font-weight: 700; cursor: pointer; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MONTHLY SUMMARY STATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.month-stats { display: grid; grid-template-columns: repeat(2,1fr); gap: 10px; }
.ms-card {
  background: #fff; border-radius: 16px; padding: 14px 16px;
  border: 1px solid var(--gray-200); box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  display: flex; align-items: center; gap: 12px;
}
.ms-icon { width: 42px; height: 42px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
.ms-val  { font-size: 22px; font-weight: 800; line-height: 1; }
.ms-lbl  { font-size: 11px; color: var(--gray-500); font-weight: 600; margin-top: 2px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CALENDAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.calendar-card {
  background: #fff; border-radius: 20px; padding: 18px 16px;
  border: 1px solid var(--gray-200); box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

.cal-nav {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px;
}
.cal-month { font-size: 16px; font-weight: 800; color: var(--gray-900); }
.cal-arrow {
  width: 34px; height: 34px; border-radius: 10px;
  background: var(--gray-100); border: none; cursor: pointer;
  font-size: 16px; display: flex; align-items: center; justify-content: center;
  transition: all 0.15s; font-family: inherit;
}
.cal-arrow:hover { background: var(--red-100); color: var(--red-500); }

.cal-weekdays {
  display: grid; grid-template-columns: repeat(7,1fr);
  margin-bottom: 6px;
}
.cal-wd {
  text-align: center; font-size: 10px; font-weight: 700;
  color: var(--gray-400); padding: 4px 0; text-transform: uppercase; letter-spacing: 0.5px;
}

.cal-grid { display: grid; grid-template-columns: repeat(7,1fr); gap: 3px; }

.cal-day {
  aspect-ratio: 1; border-radius: 10px;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 3px; cursor: pointer; transition: all 0.15s;
  position: relative; font-size: 13px; font-weight: 700; color: var(--gray-700);
  padding: 2px;
}
.cal-day:hover:not(.empty):not(.future) { background: var(--gray-100); }
.cal-day.empty { pointer-events: none; }
.cal-day.future { color: var(--gray-300); pointer-events: none; }
.cal-day.today  {
  background: var(--red-500) !important; color: #fff !important;
  box-shadow: 0 4px 12px rgba(185,28,28,0.35);
}
.cal-day.today .day-dot { background: rgba(255,255,255,0.7) !important; }

.day-num { font-size: 13px; font-weight: 700; line-height: 1; }
.day-dot { width: 5px; height: 5px; border-radius: 50%; }

.cal-day.present  { background: var(--green-light); color: var(--green); }
.cal-day.late     { background: var(--amber-light); color: var(--amber); }
.cal-day.absent   { background: var(--red-100); color: var(--red-500); }
.cal-day.leave    { background: var(--purple-light); color: var(--purple); }
.cal-day.rest     { background: var(--gray-100); color: var(--gray-400); }

.cal-day.present .day-dot  { background: var(--green); }
.cal-day.late    .day-dot  { background: var(--amber); }
.cal-day.absent  .day-dot  { background: var(--red-400); }
.cal-day.leave   .day-dot  { background: var(--purple); }
.cal-day.rest    .day-dot  { background: var(--gray-300); }

/* Legend */
.cal-legend {
  display: flex; flex-wrap: wrap; gap: 10px; margin-top: 14px;
  padding-top: 14px; border-top: 1px solid var(--gray-100);
}
.leg-item { display: flex; align-items: center; gap: 5px; font-size: 11px; font-weight: 600; color: var(--gray-600); }
.leg-dot  { width: 10px; height: 10px; border-radius: 3px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ATTENDANCE LOG TABLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.att-log {
  background: #fff; border-radius: 20px; overflow: hidden;
  border: 1px solid var(--gray-200); box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.att-log-header {
  padding: 14px 16px; border-bottom: 1px solid var(--gray-100);
  display: flex; align-items: center; justify-content: space-between;
}
.att-log-title { font-size: 14px; font-weight: 800; }

.log-row {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 16px; border-bottom: 1px solid var(--gray-50);
  transition: background 0.15s; cursor: pointer;
}
.log-row:last-child { border-bottom: none; }
.log-row:hover { background: var(--gray-50); }

.log-date-box {
  width: 44px; height: 44px; border-radius: 12px;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  flex-shrink: 0; font-weight: 800;
}
.log-date-day { font-size: 10px; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.8; }
.log-date-num { font-size: 18px; line-height: 1; }

.log-info     { flex: 1; min-width: 0; }
.log-status   { font-size: 13px; font-weight: 700; }
.log-branch   { font-size: 11px; color: var(--gray-500); margin-top: 1px; }

.log-times { text-align: right; flex-shrink: 0; }
.log-time-val  { font-size: 12px; font-weight: 700; color: var(--gray-900); }
.log-time-lbl  { font-size: 10px; color: var(--gray-400); }
.log-hours     { font-size: 11px; font-weight: 700; color: var(--gray-500); margin-top: 2px; }

.log-status-pill {
  border-radius: 20px; padding: 3px 10px;
  font-size: 10px; font-weight: 800; text-transform: uppercase;
  letter-spacing: 0.5px; flex-shrink: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CAMERA MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.75);
  z-index: 300; display: flex; align-items: flex-end;
  opacity: 0; pointer-events: none; transition: opacity 0.25s;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }

.cam-modal {
  background: #111; width: 100%; max-width: 560px; margin: 0 auto;
  border-radius: 28px 28px 0 0;
  transform: translateY(100%);
  transition: transform 0.35s cubic-bezier(.4,0,.2,1);
  overflow: hidden;
  padding-bottom: var(--safe-bottom);
}
.modal-overlay.open .cam-modal { transform: translateY(0); }

.cam-top-bar {
  padding: 14px 20px; display: flex; align-items: center; justify-content: space-between;
  background: rgba(255,255,255,0.06); border-bottom: 1px solid rgba(255,255,255,0.06);
}
.cam-modal-title { color: #fff; font-size: 16px; font-weight: 800; }
.cam-close {
  width: 34px; height: 34px; border-radius: 50%;
  background: rgba(255,255,255,0.1); border: none;
  color: #fff; font-size: 18px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
}

/* Camera view */
.cam-viewport {
  position: relative; width: 100%; background: #000;
  aspect-ratio: 4/3; overflow: hidden;
}
#cam-video {
  width: 100%; height: 100%; object-fit: cover; display: block;
}
#cam-canvas { display: none; }

.cam-overlay-frame {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  pointer-events: none;
}
.cam-face-guide {
  width: 180px; height: 220px; border-radius: 50%;
  border: 3px solid rgba(255,255,255,0.7);
  box-shadow: 0 0 0 9999px rgba(0,0,0,0.45);
  position: relative;
}
.cam-corner {
  position: absolute; width: 24px; height: 24px;
}
.cam-corner.tl { top: -3px; left: -3px; border-top: 3px solid var(--red-300); border-left: 3px solid var(--red-300); border-radius: 4px 0 0 0; }
.cam-corner.tr { top: -3px; right: -3px; border-top: 3px solid var(--red-300); border-right: 3px solid var(--red-300); border-radius: 0 4px 0 0; }
.cam-corner.bl { bottom: -3px; left: -3px; border-bottom: 3px solid var(--red-300); border-left: 3px solid var(--red-300); border-radius: 0 0 0 4px; }
.cam-corner.br { bottom: -3px; right: -3px; border-bottom: 3px solid var(--red-300); border-right: 3px solid var(--red-300); border-radius: 0 0 4px 0; }

.cam-scan-line {
  position: absolute; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, transparent, var(--red-300), transparent);
  animation: scan 2s ease-in-out infinite;
}
@keyframes scan {
  0%   { top: 10%; opacity: 1; }
  90%  { top: 90%; opacity: 1; }
  100% { top: 90%; opacity: 0; }
}

.cam-geo-indicator {
  position: absolute; top: 14px; left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
  border-radius: 20px; padding: 6px 14px;
  display: flex; align-items: center; gap: 8px;
  color: #fff; font-size: 12px; font-weight: 700;
}
.cam-geo-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green); animation: pulse-green 1.5s infinite; flex-shrink: 0; }

.cam-type-badge {
  position: absolute; bottom: 14px; left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7); backdrop-filter: blur(8px);
  border-radius: 20px; padding: 6px 16px;
  color: #fff; font-size: 13px; font-weight: 800; white-space: nowrap;
}

.cam-preview {
  width: 100%; aspect-ratio: 4/3;
  object-fit: cover; display: none;
}
.cam-preview.show { display: block; }

.cam-controls {
  padding: 20px; display: flex; flex-direction: column; gap: 10px;
  background: #111;
}

.cam-hint { text-align: center; color: rgba(255,255,255,0.5); font-size: 12px; margin-bottom: 4px; }

.btn-capture {
  width: 100%; background: var(--red-500); color: #fff;
  border: none; border-radius: 16px; padding: 15px;
  font-size: 15px; font-weight: 800; cursor: pointer; font-family: inherit;
  display: flex; align-items: center; justify-content: center; gap: 8px;
  box-shadow: 0 4px 16px rgba(185,28,28,0.4); transition: all 0.15s;
}
.btn-capture:active { transform: scale(0.98); }
.btn-capture.green  { background: var(--green); box-shadow: 0 4px 16px rgba(22,163,74,0.4); }
.btn-capture:disabled { background: var(--gray-500); box-shadow: none; cursor: not-allowed; }

.btn-retake {
  width: 100%; background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.7);
  border: none; border-radius: 16px; padding: 13px;
  font-size: 14px; font-weight: 700; cursor: pointer; font-family: inherit;
  display: none; transition: all 0.15s;
}
.btn-retake.show { display: block; }
.btn-retake:hover { background: rgba(255,255,255,0.12); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTTOM NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bottom-nav {
  position: fixed; bottom: 0; left: 0; right: 0;
  background: #fff; border-top: 1px solid var(--gray-200);
  display: grid; grid-template-columns: repeat(5,1fr);
  padding-bottom: var(--safe-bottom); z-index: 100;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
}
.bn-item {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  padding: 10px 0 8px; cursor: pointer; border: none; background: none;
  font-family: inherit; -webkit-tap-highlight-color: transparent;
  transition: all 0.15s; position: relative;
}
.bn-icon  { font-size: 22px; transition: transform 0.15s; }
.bn-label { font-size: 9px; font-weight: 700; color: var(--gray-400); letter-spacing: 0.3px; text-transform: uppercase; }
.bn-item.active .bn-label { color: var(--red-500); }
.bn-item.active .bn-icon  { transform: translateY(-2px); }
.bn-pip   { position: absolute; top: 6px; width: 4px; height: 4px; border-radius: 50%; background: var(--red-500); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SUCCESS FLASH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.success-flash {
  position: fixed; inset: 0; background: rgba(22,163,74,0.15);
  z-index: 400; pointer-events: none; opacity: 0;
  transition: opacity 0.3s;
}
.success-flash.show { opacity: 1; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast {
  position: fixed; bottom: 90px; left: 50%;
  transform: translateX(-50%) translateY(12px);
  background: var(--gray-900); color: #fff;
  border-radius: 14px; padding: 12px 20px;
  font-size: 13px; font-weight: 700; opacity: 0;
  transition: all 0.3s; z-index: 500; white-space: nowrap;
  pointer-events: none; max-width: 90vw; text-align: center;
}
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes slideUp {
  from { opacity: 0; transform: translateY(14px); }
  to   { opacity: 1; transform: translateY(0); }
}
.anim { animation: slideUp 0.4s ease both; }
.d1 { animation-delay: 0.05s; } .d2 { animation-delay: 0.10s; }
.d3 { animation-delay: 0.15s; } .d4 { animation-delay: 0.20s; }
.d5 { animation-delay: 0.25s; } .d6 { animation-delay: 0.30s; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE â€” DESKTOP 1024px+
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (min-width: 1024px) {
  .sidebar    { display: flex; }
  .main-wrap  { margin-left: var(--sidebar-w); }

  .topbar {
    padding: 20px 30px 24px;
    background: #fff; border-bottom: 1px solid var(--gray-200);
  }
  .topbar::before, .topbar::after { display: none; }
  .greeting-hello  { color: var(--gray-500); }
  .greeting-name   { color: var(--gray-900); }
  .greeting-branch { color: var(--gray-400); }
  .icon-btn  { background: var(--gray-100); border: 1px solid var(--gray-200); }

  .float-wrap   { margin-top: 0; }
  .timein-hero  { box-shadow: none; border: 1px solid var(--gray-200); }

  .content-area {
    padding: 26px 30px 40px;
    display: grid;
    grid-template-columns: 380px 1fr;
    gap: 24px;
    align-items: start;
  }

  /* Left column: time-in + stats */
  .left-col  { display: flex; flex-direction: column; gap: 20px; }
  /* Right column: calendar + log */
  .right-col { display: flex; flex-direction: column; gap: 20px; }

  .float-wrap   { grid-column: 1; }
  .section-stats   { grid-column: 1; margin-top: 0; }
  .section-cal     { grid-column: 2; grid-row: 1 / 3; margin-top: 0; }
  .section-log     { grid-column: 1 / -1; margin-top: 0; }

  .month-stats { grid-template-columns: repeat(4,1fr); }

  .bottom-nav { display: none; }
  .toast { bottom: 28px; }

  /* Modal centered on desktop */
  .modal-overlay { align-items: center; }
  .cam-modal {
    border-radius: 24px; max-width: 480px;
    transform: scale(0.92) translateY(20px);
    transition: transform 0.3s cubic-bezier(.4,0,.2,1);
  }
  .modal-overlay.open .cam-modal { transform: scale(1) translateY(0); }
}

@media (min-width: 1280px) {
  :root { --sidebar-w: 256px; }
  .content-area { padding: 28px 36px 40px; }
  .topbar { padding: 22px 36px; }
}
</style>
</head>
<body>

<div class="app-shell">

  <!-- â•â• SIDEBAR â•â• -->
  <aside class="sidebar">
    <div class="sb-logo">
      <div class="sb-logo-row">
        <div class="sb-logo-icon">GDC</div>
        <div>
          <div class="sb-logo-title">ManPower</div>
          <div class="sb-logo-sub">Employee Portal</div>
        </div>
      </div>
      <div class="sb-user-pill">ğŸ‘¤ Employee</div>
    </div>
    <div class="sb-section-lbl">Main</div>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ </span> Dashboard</button>
    <button class="sb-nav-item active" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ“…</span> My Attendance</button>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ’¸</span> Payroll</button>
    <div class="sb-section-lbl">Requests</div>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ–ï¸</span> File Leave</button>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">â°</span> Overtime</button>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ“©</span> Concerns</button>
    <div class="sb-section-lbl">Info</div>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ“¢</span> Announcements</button>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ“‹</span> My Schedule</button>
    <button class="sb-nav-item" onclick="sbNav(this)"><span class="sb-nav-icon">ğŸ‘¤</span> My Profile</button>
    <div class="sb-footer">
      <div class="sb-avatar">JD</div>
      <div>
        <div class="sb-footer-name">Juan dela Cruz</div>
        <div class="sb-footer-role">Security Guard Â· NCR North</div>
      </div>
    </div>
  </aside>

  <!-- â•â• MAIN â•â• -->
  <div class="main-wrap">

    <!-- Topbar -->
    <div class="topbar">
      <div class="topbar-inner">
        <div>
          <div class="greeting-hello">ğŸ“… Attendance</div>
          <div class="greeting-name">My Attendance</div>
          <div class="greeting-branch">NCR North Branch Â· February 2026</div>
        </div>
        <div class="topbar-right">
          <button class="icon-btn" onclick="showToast('Notifications')">ğŸ””</button>
          <button class="avatar-btn">JD</button>
        </div>
      </div>
    </div>

    <!-- Content -->
    <div class="content-area" id="content-area">

      <!-- â”€â”€ LEFT COL: Time-In Card â”€â”€ -->
      <div class="float-wrap anim d1">
        <div class="timein-hero">
          <div class="th-top">
            <div>
              <div class="th-title">ğŸ“ Geofence Time-In</div>
              <div class="th-subtitle">NCR North Branch Â· Quezon City</div>
            </div>
            <div class="geo-status-pill checking" id="geo-pill">
              <div class="geo-pulse checking" id="geo-pulse"></div>
              <span id="geo-pill-text">Checking...</span>
            </div>
          </div>

          <!-- Mini map -->
          <div class="geo-map-visual">
            <div class="geo-map-bg"></div>
            <div class="geo-zone">
              <div class="geo-zone-label">Branch<br>Area</div>
            </div>
            <div class="geo-marker inside" id="geo-marker">ğŸ“</div>
          </div>

          <!-- Geo info -->
          <div class="geo-info-row">
            <div class="geo-info-cell">
              <div class="geo-info-label">Your Location</div>
              <div class="geo-info-val" id="geo-loc-text">Detecting...</div>
            </div>
            <div class="geo-info-cell">
              <div class="geo-info-label">Distance</div>
              <div class="geo-info-val" id="geo-dist-text">â€”</div>
            </div>
            <div class="geo-info-cell">
              <div class="geo-info-label">Zone Radius</div>
              <div class="geo-info-val">100 m</div>
            </div>
          </div>

          <!-- Live clock -->
          <div class="live-clock" id="live-clock">--:--:--</div>
          <div class="live-date" id="live-date">Thursday, February 20, 2026</div>

          <!-- Button -->
          <button class="btn-geo-timein out-zone" id="timein-btn" onclick="handleTimeIn()" disabled>
            <span id="timein-btn-icon">â³</span>
            <span id="timein-btn-label">Detecting Location...</span>
          </button>

          <!-- Out of zone notice -->
          <div class="out-zone-notice" id="out-zone-notice">
            ğŸš« You are outside the assigned branch area.<br>
            Please be within 100m of NCR North Branch to time in.
          </div>

          <!-- Today times -->
          <div class="today-times">
            <div class="tt-cell">
              <div class="tt-val" id="tt-in">07:52</div>
              <div class="tt-lbl">Time In</div>
            </div>
            <div class="tt-cell">
              <div class="tt-val" id="tt-out">â€”</div>
              <div class="tt-lbl">Time Out</div>
            </div>
            <div class="tt-cell">
              <div class="tt-val" id="tt-hrs">â€”</div>
              <div class="tt-lbl">Hrs Worked</div>
            </div>
          </div>
        </div>
      </div>

      <!-- â”€â”€ Monthly Stats â”€â”€ -->
      <div class="section section-stats anim d2">
        <div class="section-header">
          <span class="section-title">February 2026 Summary</span>
        </div>
        <div class="month-stats">
          <div class="ms-card">
            <div class="ms-icon" style="background:var(--green-light)">âœ…</div>
            <div>
              <div class="ms-val" style="color:var(--green)">16</div>
              <div class="ms-lbl">Present</div>
            </div>
          </div>
          <div class="ms-card">
            <div class="ms-icon" style="background:var(--amber-light)">âš ï¸</div>
            <div>
              <div class="ms-val" style="color:var(--amber)">2</div>
              <div class="ms-lbl">Late</div>
            </div>
          </div>
          <div class="ms-card">
            <div class="ms-icon" style="background:var(--red-100)">âŒ</div>
            <div>
              <div class="ms-val" style="color:var(--red-400)">1</div>
              <div class="ms-lbl">Absent</div>
            </div>
          </div>
          <div class="ms-card">
            <div class="ms-icon" style="background:var(--purple-light)">ğŸ–ï¸</div>
            <div>
              <div class="ms-val" style="color:var(--purple)">1</div>
              <div class="ms-lbl">On Leave</div>
            </div>
          </div>
        </div>
      </div>

      <!-- â”€â”€ Monthly Calendar â”€â”€ -->
      <div class="section section-cal anim d3">
        <div class="section-header">
          <span class="section-title">Monthly Calendar</span>
          <span class="section-link" onclick="showToast('Export attendance')">Export â†’</span>
        </div>
        <div class="calendar-card">
          <div class="cal-nav">
            <button class="cal-arrow" onclick="changeMonth(-1)">â€¹</button>
            <div class="cal-month" id="cal-month-label">February 2026</div>
            <button class="cal-arrow" onclick="changeMonth(1)">â€º</button>
          </div>
          <div class="cal-weekdays">
            <div class="cal-wd">Su</div>
            <div class="cal-wd">Mo</div>
            <div class="cal-wd">Tu</div>
            <div class="cal-wd">We</div>
            <div class="cal-wd">Th</div>
            <div class="cal-wd">Fr</div>
            <div class="cal-wd">Sa</div>
          </div>
          <div class="cal-grid" id="cal-grid"></div>
          <div class="cal-legend">
            <div class="leg-item"><div class="leg-dot" style="background:var(--green)"></div>Present</div>
            <div class="leg-item"><div class="leg-dot" style="background:var(--amber)"></div>Late</div>
            <div class="leg-item"><div class="leg-dot" style="background:var(--red-400)"></div>Absent</div>
            <div class="leg-item"><div class="leg-dot" style="background:var(--purple)"></div>Leave</div>
            <div class="leg-item"><div class="leg-dot" style="background:var(--gray-300)"></div>Rest Day</div>
          </div>
        </div>
      </div>

      <!-- â”€â”€ Attendance Log â”€â”€ -->
      <div class="section section-log anim d4">
        <div class="section-header">
          <span class="section-title">Recent Attendance Log</span>
          <span class="section-link" onclick="showToast('Full history')">View All â†’</span>
        </div>
        <div class="att-log" id="att-log-list"></div>
      </div>

    </div><!-- /content-area -->
  </div><!-- /main-wrap -->
</div><!-- /app-shell -->

<!-- â•â• BOTTOM NAV â•â• -->
<nav class="bottom-nav">
  <button class="bn-item" onclick="setBn(this)"><span class="bn-icon">ğŸ </span><span class="bn-label">Home</span></button>
  <button class="bn-item active" onclick="setBn(this)"><div class="bn-pip"></div><span class="bn-icon">ğŸ“…</span><span class="bn-label">Attend</span></button>
  <button class="bn-item" onclick="setBn(this)"><span class="bn-icon">ğŸ’¸</span><span class="bn-label">Payroll</span></button>
  <button class="bn-item" onclick="setBn(this)"><span class="bn-icon">ğŸ“‹</span><span class="bn-label">Leave</span></button>
  <button class="bn-item" onclick="setBn(this)"><span class="bn-icon">ğŸ‘¤</span><span class="bn-label">Profile</span></button>
</nav>

<!-- â•â• CAMERA MODAL â•â• -->
<div class="modal-overlay" id="cam-modal-overlay" onclick="closeCamBg(event)">
  <div class="cam-modal">
    <div class="cam-top-bar">
      <div class="cam-modal-title" id="cam-modal-title">ğŸ“¸ Time In â€” Face Capture</div>
      <button class="cam-close" onclick="closeCamera()">âœ•</button>
    </div>

    <!-- Camera viewport -->
    <div class="cam-viewport">
      <video id="cam-video" autoplay playsinline muted></video>
      <img class="cam-preview" id="cam-preview" alt="Captured photo">
      <canvas id="cam-canvas"></canvas>

      <!-- Overlay guide -->
      <div class="cam-overlay-frame" id="cam-overlay">
        <div class="cam-face-guide">
          <div class="cam-corner tl"></div>
          <div class="cam-corner tr"></div>
          <div class="cam-corner bl"></div>
          <div class="cam-corner br"></div>
          <div class="cam-scan-line"></div>
        </div>
      </div>

      <!-- Geo indicator -->
      <div class="cam-geo-indicator">
        <div class="cam-geo-dot"></div>
        <span>Inside Zone Â· NCR North</span>
      </div>

      <!-- Time-in / Time-out badge -->
      <div class="cam-type-badge" id="cam-type-badge">â° TIME IN</div>
    </div>

    <!-- Controls -->
    <div class="cam-controls">
      <div class="cam-hint" id="cam-hint">Position your face inside the oval and take a photo</div>
      <button class="btn-capture" id="btn-capture" onclick="capturePhoto()">
        ğŸ“· Take Photo
      </button>
      <button class="btn-retake" id="btn-retake" onclick="retakePhoto()">â†©ï¸ Retake</button>
    </div>
  </div>
</div>

<!-- â•â• SUCCESS FLASH â•â• -->
<div class="success-flash" id="success-flash"></div>

<!-- â•â• TOAST â•â• -->
<div class="toast" id="toast"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
// Simulated branch location (NCR North, Quezon City)
const BRANCH = { lat: 14.6760, lng: 121.0437, radius: 100 };

// Attendance data for February 2026
const attData = {
  '2026-02-01': { status: 'rest' },
  '2026-02-02': { status: 'present', in: '07:55', out: '17:02', hrs: '9.1h', branch: 'NCR North' },
  '2026-02-03': { status: 'present', in: '07:48', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-04': { status: 'present', in: '08:01', out: '17:05', hrs: '9.1h', branch: 'NCR North' },
  '2026-02-05': { status: 'present', in: '07:50', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-06': { status: 'late',    in: '08:35', out: '17:10', hrs: '8.6h', branch: 'NCR North' },
  '2026-02-07': { status: 'present', in: '07:55', out: '17:00', hrs: '9.1h', branch: 'NCR North' },
  '2026-02-08': { status: 'rest' },
  '2026-02-09': { status: 'present', in: '07:52', out: '17:03', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-10': { status: 'present', in: '07:49', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-11': { status: 'leave',   in: 'â€”',    out: 'â€”',    hrs: 'â€”',   branch: 'Vacation Leave' },
  '2026-02-12': { status: 'absent',  in: 'â€”',    out: 'â€”',    hrs: 'â€”',   branch: 'NCR North' },
  '2026-02-13': { status: 'present', in: '07:58', out: '17:01', hrs: '9.1h', branch: 'NCR North' },
  '2026-02-14': { status: 'present', in: '07:50', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-15': { status: 'rest' },
  '2026-02-16': { status: 'present', in: '07:55', out: '17:02', hrs: '9.1h', branch: 'NCR North' },
  '2026-02-17': { status: 'present', in: '07:48', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-18': { status: 'present', in: '07:50', out: '17:00', hrs: '9.2h', branch: 'NCR North' },
  '2026-02-19': { status: 'late',    in: '08:42', out: '17:15', hrs: '8.5h', branch: 'NCR North' },
  '2026-02-20': { status: 'present', in: '07:52', out: 'â€”',    hrs: 'â€”',   branch: 'NCR North' },
};

const statusConfig = {
  present: { label: 'Present',  bg: 'var(--green-light)',   color: 'var(--green)',   pillBg: '#dcfce7', pillColor: '#16a34a', dateBg: '#dcfce7', dateColor: '#16a34a' },
  late:    { label: 'Late',     bg: 'var(--amber-light)',   color: 'var(--amber)',   pillBg: '#fef3c7', pillColor: '#d97706', dateBg: '#fef3c7', dateColor: '#d97706' },
  absent:  { label: 'Absent',   bg: 'var(--red-100)',       color: 'var(--red-400)', pillBg: '#fee2e2', pillColor: '#dc2626', dateBg: '#fee2e2', dateColor: '#dc2626' },
  leave:   { label: 'On Leave', bg: 'var(--purple-light)',  color: 'var(--purple)',  pillBg: '#ede9fe', pillColor: '#7c3aed', dateBg: '#ede9fe', dateColor: '#7c3aed' },
  rest:    { label: 'Rest Day', bg: 'var(--gray-100)',      color: 'var(--gray-400)',pillBg: '#f3f4f6', pillColor: '#9ca3af', dateBg: '#f3f4f6', dateColor: '#9ca3af' },
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CALENDAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let calYear = 2026, calMonth = 1; // 0-indexed month, 1 = February

const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const dayNames   = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

function changeMonth(dir) {
  calMonth += dir;
  if (calMonth > 11) { calMonth = 0; calYear++; }
  if (calMonth < 0)  { calMonth = 11; calYear--; }
  renderCalendar();
}

function renderCalendar() {
  const label = document.getElementById('cal-month-label');
  label.textContent = `${monthNames[calMonth]} ${calYear}`;

  const grid = document.getElementById('cal-grid');
  grid.innerHTML = '';

  const firstDay = new Date(calYear, calMonth, 1).getDay();
  const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
  const today = new Date();
  const todayStr = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;

  // Empty cells before first day
  for (let i = 0; i < firstDay; i++) {
    const empty = document.createElement('div');
    empty.className = 'cal-day empty';
    grid.appendChild(empty);
  }

  for (let d = 1; d <= daysInMonth; d++) {
    const dateStr = `${calYear}-${String(calMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const dayDate = new Date(calYear, calMonth, d);
    const isFuture = dayDate > today && dateStr !== todayStr;
    const isToday  = dateStr === todayStr;
    const att = attData[dateStr];

    const el = document.createElement('div');
    el.className = 'cal-day';

    if (isToday) {
      el.classList.add('today');
    } else if (isFuture) {
      el.classList.add('future');
    } else if (att) {
      el.classList.add(att.status);
    }

    el.innerHTML = `
      <div class="day-num">${d}</div>
      ${!isFuture && !isToday && att ? `<div class="day-dot"></div>` : ''}
    `;

    if (!isFuture && att && !isToday) {
      el.title = statusConfig[att.status]?.label || '';
      el.onclick = () => showDayDetail(dateStr, att, d);
    }

    grid.appendChild(el);
  }
}

function showDayDetail(dateStr, att, day) {
  if (!att || att.status === 'rest') return;
  const sc = statusConfig[att.status];
  const msg = `${day} Feb â€” ${sc.label}: In ${att.in} Â· Out ${att.out}`;
  showToast(msg);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ATTENDANCE LOG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderLog() {
  const container = document.getElementById('att-log-list');
  const entries = Object.entries(attData)
    .filter(([,v]) => v.status !== 'rest')
    .sort((a,b) => b[0].localeCompare(a[0]))
    .slice(0,8);

  container.innerHTML = entries.map(([dateStr, att]) => {
    const d = new Date(dateStr + 'T00:00:00');
    const sc = statusConfig[att.status];
    return `
      <div class="log-row">
        <div class="log-date-box" style="background:${sc.pillBg};color:${sc.pillColor}">
          <div class="log-date-day">${dayNames[d.getDay()]}</div>
          <div class="log-date-num">${d.getDate()}</div>
        </div>
        <div class="log-info">
          <div class="log-status" style="color:${sc.pillColor}">${sc.label}</div>
          <div class="log-branch">ğŸ“ ${att.branch}</div>
        </div>
        <div class="log-times">
          <div class="log-time-val">${att.in}</div>
          <div class="log-time-lbl">Time In</div>
          <div class="log-hours">${att.hrs}</div>
        </div>
        <div class="log-status-pill" style="background:${sc.pillBg};color:${sc.pillColor}">${sc.label.toUpperCase()}</div>
      </div>
    `;
  }).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LIVE CLOCK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function tickClock() {
  const now = new Date();
  const pad = n => String(n).padStart(2,'0');
  document.getElementById('live-clock').textContent =
    `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
}
const days2 = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
const now0  = new Date();
document.getElementById('live-date').textContent =
  `${days2[now0.getDay()]}, ${monthNames[now0.getMonth()]} ${now0.getDate()}, ${now0.getFullYear()}`;
setInterval(tickClock, 1000);
tickClock();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GEOFENCING LOGIC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let geoInside = false, geoChecked = false;
let timeInDone = true; // already timed in today at 07:52
let timeOutDone = false;

function haversineDistance(lat1, lng1, lat2, lng2) {
  const R = 6371000;
  const dLat = (lat2-lat1)*Math.PI/180;
  const dLng = (lng2-lng1)*Math.PI/180;
  const a = Math.sin(dLat/2)**2 +
    Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLng/2)**2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
}

function setGeoStatus(inside, dist) {
  const pill  = document.getElementById('geo-pill');
  const pulse = document.getElementById('geo-pulse');
  const pillText = document.getElementById('geo-pill-text');
  const notice   = document.getElementById('out-zone-notice');
  const btn      = document.getElementById('timein-btn');
  const btnIcon  = document.getElementById('timein-btn-icon');
  const btnLabel = document.getElementById('timein-btn-label');
  const marker   = document.getElementById('geo-marker');
  const distEl   = document.getElementById('geo-dist-text');

  geoInside = inside;
  distEl.textContent = dist < 1000 ? `${Math.round(dist)} m` : `${(dist/1000).toFixed(1)} km`;

  if (inside) {
    pill.className    = 'geo-status-pill inside';
    pulse.className   = 'geo-pulse inside';
    pillText.textContent = 'Inside Zone';
    marker.className  = 'geo-marker inside';
    notice.classList.remove('show');

    if (!timeInDone) {
      btn.className = 'btn-geo-timein ready'; btn.disabled = false;
      btnIcon.textContent = 'â°'; btnLabel.textContent = 'Time In Now';
    } else if (!timeOutDone) {
      btn.className = 'btn-geo-timein clocked-out'; btn.disabled = false;
      btnIcon.textContent = 'ğŸ'; btnLabel.textContent = 'Time Out Now';
    } else {
      btn.className = 'btn-geo-timein done'; btn.disabled = true;
      btnIcon.textContent = 'âœ…'; btnLabel.textContent = 'Attendance Complete';
    }
  } else {
    pill.className    = 'geo-status-pill outside';
    pulse.className   = 'geo-pulse outside';
    pillText.textContent = 'Outside Zone';
    marker.className  = 'geo-marker outside';
    notice.classList.add('show');
    btn.className = 'btn-geo-timein out-zone'; btn.disabled = true;
    btnIcon.textContent = 'ğŸš«'; btnLabel.textContent = 'Outside Branch Area';
  }
}

function startGeolocation() {
  const locEl = document.getElementById('geo-loc-text');

  if (!navigator.geolocation) {
    // Simulate being inside for demo
    locEl.textContent = 'Quezon City (demo)';
    document.getElementById('geo-dist-text').textContent = '42 m';
    setGeoStatus(true, 42);
    return;
  }

  navigator.geolocation.watchPosition(
    (pos) => {
      const { latitude: lat, longitude: lng } = pos.coords;
      const dist = haversineDistance(lat, lng, BRANCH.lat, BRANCH.lng);
      locEl.textContent = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
      setGeoStatus(dist <= BRANCH.radius, dist);
    },
    (err) => {
      // Fallback demo mode
      locEl.textContent = 'NCR North (demo)';
      document.getElementById('geo-dist-text').textContent = '28 m';
      setGeoStatus(true, 28);
    },
    { enableHighAccuracy: true, maximumAge: 10000 }
  );
}

// Simulate geo check after 2 seconds for demo
setTimeout(() => {
  document.getElementById('geo-loc-text').textContent = 'Quezon City (demo)';
  setGeoStatus(true, 38);
  // Already timed in
  const btn = document.getElementById('timein-btn');
  btn.className = 'btn-geo-timein clocked-out'; btn.disabled = false;
  document.getElementById('timein-btn-icon').textContent = 'ğŸ';
  document.getElementById('timein-btn-label').textContent = 'Time Out Now';
}, 2000);

startGeolocation();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIME IN / OUT FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let camStream = null;
let capturedBlob = null;
let currentMode = 'timein'; // 'timein' or 'timeout'

function handleTimeIn() {
  if (!geoInside) return;
  currentMode = timeInDone ? 'timeout' : 'timein';
  document.getElementById('cam-modal-title').textContent =
    currentMode === 'timein' ? 'ğŸ“¸ Time In â€” Face Capture' : 'ğŸ“¸ Time Out â€” Face Capture';
  document.getElementById('cam-type-badge').textContent =
    currentMode === 'timein' ? 'â° TIME IN' : 'ğŸ TIME OUT';
  openCamera();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CAMERA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function openCamera() {
  document.getElementById('cam-modal-overlay').classList.add('open');
  capturedBlob = null;
  resetCamUI();

  try {
    camStream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: 'user', width: { ideal: 1280 }, height: { ideal: 960 } },
      audio: false
    });
    const video = document.getElementById('cam-video');
    video.srcObject = camStream;
    video.style.display = 'block';
    document.getElementById('cam-preview').classList.remove('show');
    document.getElementById('cam-overlay').style.display = 'flex';
  } catch (err) {
    // Camera not available â€” demo mode
    showDemoCam();
  }
}

function showDemoCam() {
  // Show a placeholder when camera is unavailable
  const video = document.getElementById('cam-video');
  video.style.display = 'none';
  const viewport = video.parentElement;
  let demoEl = document.getElementById('demo-cam-placeholder');
  if (!demoEl) {
    demoEl = document.createElement('div');
    demoEl.id = 'demo-cam-placeholder';
    demoEl.style.cssText = 'width:100%;aspect-ratio:4/3;background:linear-gradient(135deg,#1a1a2e,#16213e);display:flex;align-items:center;justify-content:center;flex-direction:column;gap:12px;color:rgba(255,255,255,0.7);font-size:14px;font-weight:700;';
    demoEl.innerHTML = '<div style="font-size:60px">ğŸ“·</div><div>Camera not available</div><div style="font-size:11px;opacity:0.5;font-weight:500">Demo mode â€” tap capture to simulate</div>';
    viewport.insertBefore(demoEl, video.nextSibling);
  }
  demoEl.style.display = 'flex';
  document.getElementById('cam-overlay').style.display = 'none';
  document.getElementById('cam-hint').textContent = 'Demo mode: tap Capture to simulate';
}

function closeCamera() {
  stopStream();
  document.getElementById('cam-modal-overlay').classList.remove('open');
  resetCamUI();
  const ph = document.getElementById('demo-cam-placeholder');
  if (ph) ph.style.display = 'none';
}

function closeCamBg(e) {
  if (e.target === document.getElementById('cam-modal-overlay')) closeCamera();
}

function stopStream() {
  if (camStream) { camStream.getTracks().forEach(t => t.stop()); camStream = null; }
}

function resetCamUI() {
  document.getElementById('btn-capture').disabled = false;
  document.getElementById('btn-capture').textContent = 'ğŸ“· Take Photo';
  document.getElementById('btn-capture').classList.remove('green');
  document.getElementById('btn-retake').classList.remove('show');
  document.getElementById('cam-preview').classList.remove('show');
  document.getElementById('cam-hint').textContent = 'Position your face inside the oval and take a photo';
  document.getElementById('cam-overlay').style.display = 'flex';

  const video = document.getElementById('cam-video');
  if (camStream) { video.srcObject = camStream; video.style.display = 'block'; }
}

function capturePhoto() {
  const video  = document.getElementById('cam-video');
  const canvas = document.getElementById('cam-canvas');
  const preview = document.getElementById('cam-preview');
  const isDemoMode = !camStream;

  if (!isDemoMode && video.readyState >= 2) {
    canvas.width  = video.videoWidth;
    canvas.height = video.videoHeight;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0);
    const dataUrl = canvas.toDataURL('image/jpeg', 0.85);
    preview.src = dataUrl;
    preview.classList.add('show');
    video.style.display = 'none';
  } else {
    // Demo: show a colored placeholder
    preview.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="640" height="480"><rect width="640" height="480" fill="%231a1a2e"/><text x="320" y="220" font-size="80" text-anchor="middle">ğŸ‘¤</text><text x="320" y="310" font-size="24" fill="%23fff" text-anchor="middle" font-family="sans-serif">Photo Captured (Demo)</text></svg>';
    preview.classList.add('show');
    video.style.display = 'none';
  }

  document.getElementById('cam-overlay').style.display = 'none';
  document.getElementById('btn-capture').textContent = 'âœ… Confirm & Submit';
  document.getElementById('btn-capture').classList.add('green');
  document.getElementById('btn-retake').classList.add('show');
  document.getElementById('cam-hint').textContent = 'Photo looks good? Tap confirm to record attendance.';

  // Second tap = confirm
  document.getElementById('btn-capture').onclick = confirmCapture;
}

function retakePhoto() {
  resetCamUI();
  document.getElementById('btn-capture').onclick = capturePhoto;

  if (camStream) {
    const video = document.getElementById('cam-video');
    video.srcObject = camStream;
    video.style.display = 'block';
  } else {
    const ph = document.getElementById('demo-cam-placeholder');
    if (ph) ph.style.display = 'flex';
    document.getElementById('cam-hint').textContent = 'Demo mode: tap Capture to simulate';
  }
}

function confirmCapture() {
  stopStream();
  document.getElementById('cam-modal-overlay').classList.remove('open');
  document.getElementById('btn-capture').onclick = capturePhoto;

  const now = new Date();
  const pad = n => String(n).padStart(2,'0');
  const ts = `${pad(now.getHours())}:${pad(now.getMinutes())}`;

  // Flash
  const flash = document.getElementById('success-flash');
  flash.classList.add('show');
  setTimeout(() => flash.classList.remove('show'), 600);

  if (currentMode === 'timein') {
    timeInDone = true;
    document.getElementById('tt-in').textContent = ts;
    showToast(`âœ… Time In recorded: ${ts}`);
    setGeoStatus(true, 38); // update button to Time Out
  } else {
    timeOutDone = true;
    document.getElementById('tt-out').textContent = ts;
    document.getElementById('tt-hrs').textContent = '9.0h';
    showToast(`ğŸ Time Out recorded: ${ts}`);
    // Disable button
    const btn = document.getElementById('timein-btn');
    btn.className = 'btn-geo-timein done'; btn.disabled = true;
    document.getElementById('timein-btn-icon').textContent = 'âœ…';
    document.getElementById('timein-btn-label').textContent = 'Attendance Complete';
  }

  const ph = document.getElementById('demo-cam-placeholder');
  if (ph) ph.style.display = 'none';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setBn(btn) {
  document.querySelectorAll('.bn-item').forEach(b => {
    b.classList.remove('active');
    b.querySelector('.bn-pip')?.remove();
  });
  btn.classList.add('active');
  const pip = document.createElement('div'); pip.className = 'bn-pip';
  btn.prepend(pip);
}
function sbNav(btn) {
  document.querySelectorAll('.sb-nav-item').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 3000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
renderCalendar();
renderLog();
</script>
</body>
</html>